1) Descobrir IPs na rede (descoberta de alvos)

netdiscover (ARP passive/active)

netdiscover -i <interface> - modo interactivo/passivo.

netdiscover -r 192.168.1.0/24 -i <interface> - varrimento ARP no range.

arp-scan (rápido e fiável em LAN)

sudo arp-scan --interface=<interface> --localnet

usar tabela ARP do próprio host para verificar vizinhos:

ip neigh ou arp -a

quando a rede for grande, combinar com DNS/LDAP/AD enumeration e serviços de DHCP para mapear endereços atribuídos.

2) Descobrir portos (varrimento de portos)

nmap - comandos exemplares e explicação rápida:

nmap -sS -p- -T4 -Pn -oA scan_full 192.168.1.10
(SYN scan, todos os portos, timing rápido, não faz ping antes, output em todos os formatos)

nmap -sV -sC -p80,443,22 -T4 -oA scan_services 192.168.1.0/24
(detecção de versão + scripts default)

nmap -A -O --top-ports 100 10.0.0.0/24
(agressivo: detecção de serviços, SO e scripts; usar com cuidado)

flags úteis:

-p- - pesquisar todos os 65535 portos.

-sS - SYN stealth scan.

-sT - TCP connect (quando não há privilégios).

-Pn - assume hosts up (útil quando ICMP ou ping bloqueado).

-T0..5 - tempo (T0 mais stealth, T5 mais rápido/ruidoso).

--open - só reporta portos abertos.

-oA nome - guarda output em nome.nmap, nome.xml, nome.gnmap.

masscan - para varrimentos ultra-rápidos em large-scale:

masscan 10.0.0.0/8 -p0-65535 --rate=10000 -oL masscan.out

importar resultados para nmap para validação (nmap -sV -iL targets.txt)

rustscan -  alternativa rápida que pesquisa com nmap:

rustscan -a 192.168.1.10 -- -sV -A
